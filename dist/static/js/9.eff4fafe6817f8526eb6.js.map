{"version":3,"sources":["webpack:///src/page/manage/children/shopList.vue","webpack:///./src/page/manage/children/shopList.vue?fd08","webpack:///./src/page/manage/children/shopList.vue"],"names":["shopList","data","tableData","totalCount","offset","city","showDialog","form","baseUrl","env","baseImgPath","options","selectedOption","mounted","this","initData","methods","_this","asyncToGenerator_default","regenerator_default","a","mark","_callee","res","wrap","_context","prev","next","Object","getData","sent","status","count","getShops","stop","_this2","_callee2","_city","latitude","longitude","_context2","Array","forEach","item","shop","name","address","description","id","phone","rating","recent_order_num","category","image_path","push","console","log","handleCurrentChange","page","handleEdit","index","split","length","getCategory","beforeUpload","file","rightType","type","lt2M","size","$message","message","uploadSuccess","error","_this3","_callee3","_context3","option","value","label","sub_categories","children","subitem","querySearch","query","cb","_this4","_callee4","cityList","_context4","city_id","keyword","map","updateShop","_this5","_callee5","_context5","join","t0","addFood","row","$router","path","restaurant_id","handleDelete","_this6","$confirm","confirmButtonText","cacelButtonText","then","_callee6","_context6","success","catch","info","components","headTop","children_shopList","render","_vm","_h","$createElement","_c","_self","attrs","_v","staticClass","staticStyle","width","scopedSlots","_u","key","fn","label-position","inline","_s","property","align","scope","padding","on","click","$event","$index","margin-left","margin-bottom","background","layout","page-size","total","current-change","title","visible","modal-append-to-body","update:visible","model","label-width","callback","$$v","$set","expression","fetch-suggestions","trigger-on-focus","placeholder","change-on-select","action","before-upload","on-success","show-file-list","src","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/9.eff4fafe6817f8526eb6.js","sourcesContent":["<template>\r\n    <div id='shoplist'>\r\n        <head-top></head-top>\r\n        <div class=\"table-wrapper\">\r\n            <el-table :data=\"tableData\" style=\"width: 100%\">\r\n                <el-table-column type=\"expand\">\r\n                    <template slot-scope=\"data\">\r\n                        <el-form label-position=\"left\" inline class=\"form\">\r\n                            <el-form-item label=\"店铺名称\">\r\n                                <span>{{data.row.name}}</span>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"店铺地址\">\r\n                                <span>{{data.row.address}}</span>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"店铺介绍\">\r\n                                <span>{{data.row.description}}</span>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"店铺 ID\">\r\n                                <span>{{data.row.id}}</span>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"联系电话\">\r\n                                <span>{{data.row.phone}}</span>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"评分\">\r\n                                <span>{{data.row.rating}}</span>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"销售量\">\r\n                                <span>{{data.row.recent_order_num}}</span>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"分类\">\r\n                                <span>{{data.row.category}}</span>\r\n                            </el-form-item>\r\n                        </el-form>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column property=\"name\" label=\"店铺名称\" align=\"center\"></el-table-column>\r\n                <el-table-column property=\"address\" label=\"店铺地址\" align=\"center\"></el-table-column>\r\n                <el-table-column property=\"description\" label=\"店铺介绍\" align=\"center\"></el-table-column>\r\n                <el-table-column label=\"操作\" width=\"200\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button style=\"padding: 5px\" size=\"mini\" @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>\r\n                        <el-button style=\"padding: 5px\" size=\"mini\" type=\"success\" @click=\"addFood(scope.$index, scope.row)\">添加食品</el-button>\r\n                        <el-button style=\"padding: 5px\" size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n        </div>\r\n        <el-pagination style=\"margin-left: 40px; margin-bottom:40px\" background layout=\"prev, pager, next, total\" :page-size=\"20\" :total=\"totalCount\" @current-change=\"handleCurrentChange\"></el-pagination>\r\n        <el-dialog title=\"修改店铺信息\" :visible.sync=\"showDialog\" :modal-append-to-body=\"false\">\r\n            <el-form :model=\"form\" label-width=\"100px\">\r\n                <el-form-item label=\"店铺名称\">\r\n                    <el-input v-model=\"form.name\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"详细地址\">\r\n                    <el-autocomplete :fetch-suggestions=\"querySearch\" :trigger-on-focus=\"false\" v-model=\"form.address\" placeholder=\"请输入地址\" style=\"width: 100%;\"></el-autocomplete>\r\n                    <span>当前城市：广州</span>\r\n                </el-form-item>\r\n                <el-form-item label=\"店铺介绍\">\r\n                    <el-input v-model=\"form.description\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"联系电话\">\r\n                    <el-input v-model=\"form.phone\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"店铺分类\">\r\n                    <el-cascader :options=\"options\" v-model=\"selectedOption\" change-on-select></el-cascader>\r\n                </el-form-item>\r\n                <el-form-item label=\"商铺图片\">\r\n                    <el-upload class=\"upload\" :action=\"baseUrl + '/v1/addimg/shop'\" :before-upload=\"beforeUpload\" :on-success=\"uploadSuccess\" :show-file-list=\"false\">\r\n                        <img v-if=\"form.image_path\" :src=\"baseImgPath + form.image_path\" class=\"avatar\">\r\n                        <i v-else class=\"el-icon-plus upload-icon\"></i>\r\n                    </el-upload>\r\n                </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\">\r\n                <el-button @click=\"showDialog = false\" size=\"small\">取 消</el-button>\r\n                <el-button @click=\"updateShop\" type=\"primary\" size=\"small\">确 定</el-button>\r\n            </div>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import headTop from '../../../components/headTop'\r\n    import { cityGuess, shopCount, shopList, categoryList, addressList, updateRestaurant, deleteShop } from '../../../service/getData';\r\n    import { baseUrl, baseImgPath } from '../../../utils/env';\r\n\r\n    export default {\r\n        data () {\r\n            return {\r\n                tableData: [],\r\n                totalCount: 0,\r\n                offset: 0,\r\n                city: null,\r\n                showDialog: false,\r\n                form: {},\r\n                baseUrl,\r\n                baseImgPath,\r\n                options: [],\r\n                selectedOption: []\r\n            }\r\n        },\r\n        mounted () {\r\n            this.initData();\r\n        },\r\n        methods: {\r\n            async initData () {\r\n                // 取得商铺数量\r\n                let res = await shopCount();\r\n                if (res.status === 1) {\r\n                    this.totalCount = res.count;\r\n                }\r\n\r\n                // 定位当前城市\r\n                this.city = await cityGuess();\r\n                this.getShops();\r\n            },\r\n            async getShops () {\r\n                this.tableData = []; // 清空表格数据\r\n                let {latitude, longitude} = this.city;\r\n                let res = await shopList({latitude, longitude, offset: this.offset});\r\n                if (res instanceof Array) {\r\n                    res.forEach(item => {\r\n                        let shop = {};\r\n                        shop.name = item.name;\r\n                        shop.address = item.address;\r\n                        shop.description = item.description;\r\n                        shop.id = item.id;\r\n                        shop.phone = item.phone;\r\n                        shop.rating = item.rating;\r\n                        shop.recent_order_num = item.recent_order_num;\r\n                        shop.category = item.category;\r\n                        shop.image_path = item.image_path;\r\n                        this.tableData.push(shop);\r\n                    });\r\n                } else {\r\n                    console.log('获取商家列表失败!');\r\n                }\r\n            },\r\n            handleCurrentChange (page) {\r\n                this.offset = 20 * (page - 1);\r\n                this.getShops();\r\n            },\r\n            handleEdit (index, data) {\r\n                this.showDialog = true;\r\n                this.form = data;\r\n                // 把商品分类转换为数组，便于级联选择器使用\r\n                this.selectedOption = data.category.split('/');\r\n                if (!this.options.length) {\r\n                    this.getCategory();\r\n                }\r\n            },\r\n            beforeUpload (file) {\r\n                const rightType = (file.type === 'image/jpeg') || (file.type === 'image/png');\r\n                const lt2M = file.size / 1024 / 1024 < 1.5;\r\n\r\n                if (!rightType) {\r\n                    this.$message({\r\n                        type: 'error',\r\n                        message: '上传头像图片只能是 JPG 格式!'\r\n                    });\r\n                    return false;\r\n                }\r\n                if (!lt2M) {\r\n                    this.$message({\r\n                        type: 'error',\r\n                        message: '上传头像图片大小不能超过1.5MB!'\r\n                    });\r\n                    return false;\r\n                }\r\n            },\r\n            uploadSuccess (res) {\r\n                if (res.status === 1) {\r\n                    this.form.image_path = res.image_path;\r\n                } else {\r\n                    this.$message.error('上传头像失败!');\r\n                }\r\n            },\r\n            async getCategory () {\r\n                const categories = await categoryList();\r\n\r\n                // 格式化分类列表\r\n                categories.forEach(item => {\r\n                    let option = {\r\n                        value: item.name,\r\n                        label: item.name\r\n                    }\r\n                    if (item.sub_categories.length) {\r\n                        option.children = [];\r\n                        item.sub_categories.forEach((subitem, index) => {\r\n                            if (index === 0) return;\r\n                            option.children.push({\r\n                                value: subitem.name,\r\n                                label: subitem.name\r\n                            });\r\n                        });\r\n                    }\r\n                    this.options.push(option);\r\n                });\r\n            },\r\n            async querySearch (query, cb) {\r\n                if (query !== '') {\r\n                    let cityList = await addressList({city_id: this.city.id, keyword: query});\r\n                    if (cityList instanceof Array) {\r\n                        // 格式化地址列表，以便输入建议使用\r\n                        cityList.map(item => {\r\n                            item.value = item.address;\r\n                            return item;\r\n                        });\r\n                        cb(cityList);\r\n                    }\r\n                }\r\n            },\r\n            async updateShop () {\r\n                this.showDialog = false;\r\n                // 更新商品分类\r\n                this.form.category = this.selectedOption.join('/');\r\n\r\n                try {\r\n                    let res = await updateRestaurant(this.form);\r\n                    if (res.status === 1) {\r\n                        this.$message({\r\n                            type: 'success',\r\n                            message: '更新店铺信息成功'\r\n                        });\r\n                        this.getShops();\r\n                    } else {\r\n                        this.$message({\r\n                            type: 'error',\r\n                            message: res.message\r\n                        });\r\n                    }\r\n                } catch (e) {\r\n                    console.log('更新店铺信息失败', e);\r\n                }\r\n            },\r\n            addFood (index, row) {\r\n                this.$router.push({path: '/manage/addfood', query: {restaurant_id: row.id}});\r\n            },\r\n            handleDelete (index, data) {\r\n                this.$confirm('确定删除该商家吗?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cacelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(async () => {\r\n                    let res = await deleteShop(data.id);\r\n                    if (res.status === 1) {\r\n                        this.$message.success('删除店铺成功！');\r\n                        this.getShops();\r\n                    } else {\r\n                        this.$message.error(res.message);\r\n                        console.log('删除店铺失败');\r\n                    }\r\n                }).catch(() => {\r\n                    this.$message.info('已取消删除');\r\n                })\r\n            }\r\n        },\r\n        components: {\r\n            headTop\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n    .table-wrapper{\r\n        padding: 20px;\r\n    }\r\n    .form{\r\n        font-size: 0;\r\n    }\r\n    .form .el-form-item{\r\n        width: 50%;\r\n        margin: 0;\r\n    }\r\n    // 因为label标签是子组件的元素，当scoped属性存在时，需使用深度作用选择器( >>> 或 /deep/ )才能选中label标签\r\n    .form /deep/ .el-form-item__label{\r\n        width: 90px;\r\n        color: #99a9bf;\r\n    }\r\n    .upload /deep/ .el-upload{\r\n        border: 1px dashed #d9d9d9;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        overflow: hidden;\r\n        position: relative;\r\n    }\r\n    .upload /deep/ .el-upload:hover{\r\n        border-color: #409eff;\r\n    }\r\n    .upload-icon{\r\n        font-size: 28px;\r\n        width: 120px;\r\n        height: 120px;\r\n        line-height: 120px;\r\n        color: #8c939d;\r\n        text-align: center;\r\n    }\r\n    .avatar{\r\n        height: 120px;\r\n        width: 120px;\r\n        display: block;\r\n    }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/page/manage/children/shopList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"shoplist\"}},[_c('head-top'),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper\"},[_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.tableData}},[_c('el-table-column',{attrs:{\"type\":\"expand\"},scopedSlots:_vm._u([{key:\"default\",fn:function(data){return [_c('el-form',{staticClass:\"form\",attrs:{\"label-position\":\"left\",\"inline\":\"\"}},[_c('el-form-item',{attrs:{\"label\":\"店铺名称\"}},[_c('span',[_vm._v(_vm._s(data.row.name))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"店铺地址\"}},[_c('span',[_vm._v(_vm._s(data.row.address))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"店铺介绍\"}},[_c('span',[_vm._v(_vm._s(data.row.description))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"店铺 ID\"}},[_c('span',[_vm._v(_vm._s(data.row.id))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"联系电话\"}},[_c('span',[_vm._v(_vm._s(data.row.phone))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"评分\"}},[_c('span',[_vm._v(_vm._s(data.row.rating))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"销售量\"}},[_c('span',[_vm._v(_vm._s(data.row.recent_order_num))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"分类\"}},[_c('span',[_vm._v(_vm._s(data.row.category))])])],1)]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"property\":\"name\",\"label\":\"店铺名称\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"property\":\"address\",\"label\":\"店铺地址\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"property\":\"description\",\"label\":\"店铺介绍\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"200\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{staticStyle:{\"padding\":\"5px\"},attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.handleEdit(scope.$index, scope.row)}}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"padding\":\"5px\"},attrs:{\"size\":\"mini\",\"type\":\"success\"},on:{\"click\":function($event){return _vm.addFood(scope.$index, scope.row)}}},[_vm._v(\"添加食品\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"padding\":\"5px\"},attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.handleDelete(scope.$index, scope.row)}}},[_vm._v(\"删除\")])]}}])})],1)],1),_vm._v(\" \"),_c('el-pagination',{staticStyle:{\"margin-left\":\"40px\",\"margin-bottom\":\"40px\"},attrs:{\"background\":\"\",\"layout\":\"prev, pager, next, total\",\"page-size\":20,\"total\":_vm.totalCount},on:{\"current-change\":_vm.handleCurrentChange}}),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"修改店铺信息\",\"visible\":_vm.showDialog,\"modal-append-to-body\":false},on:{\"update:visible\":function($event){_vm.showDialog=$event}}},[_c('el-form',{attrs:{\"model\":_vm.form,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"店铺名称\"}},[_c('el-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"详细地址\"}},[_c('el-autocomplete',{staticStyle:{\"width\":\"100%\"},attrs:{\"fetch-suggestions\":_vm.querySearch,\"trigger-on-focus\":false,\"placeholder\":\"请输入地址\"},model:{value:(_vm.form.address),callback:function ($$v) {_vm.$set(_vm.form, \"address\", $$v)},expression:\"form.address\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"当前城市：广州\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"店铺介绍\"}},[_c('el-input',{model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"联系电话\"}},[_c('el-input',{model:{value:(_vm.form.phone),callback:function ($$v) {_vm.$set(_vm.form, \"phone\", $$v)},expression:\"form.phone\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"店铺分类\"}},[_c('el-cascader',{attrs:{\"options\":_vm.options,\"change-on-select\":\"\"},model:{value:(_vm.selectedOption),callback:function ($$v) {_vm.selectedOption=$$v},expression:\"selectedOption\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"商铺图片\"}},[_c('el-upload',{staticClass:\"upload\",attrs:{\"action\":_vm.baseUrl + '/v1/addimg/shop',\"before-upload\":_vm.beforeUpload,\"on-success\":_vm.uploadSuccess,\"show-file-list\":false}},[(_vm.form.image_path)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.baseImgPath + _vm.form.image_path}}):_c('i',{staticClass:\"el-icon-plus upload-icon\"})])],1)],1),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){_vm.showDialog = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.updateShop}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1ee3c6d0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/page/manage/children/shopList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1ee3c6d0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./shopList.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./shopList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./shopList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1ee3c6d0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./shopList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1ee3c6d0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/page/manage/children/shopList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}